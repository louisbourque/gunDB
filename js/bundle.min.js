!function n(e,t,o){function i(u,a){if(!t[u]){if(!e[u]){var s="function"==typeof require&&require;if(!a&&s)return s(u,!0);if(r)return r(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var c=t[u]={exports:{}};e[u][0].call(c.exports,function(n){var t=e[u][1][n];return i(t?t:n)},c,c.exports,n,e,t,o)}return t[u].exports}for(var r="function"==typeof require&&require,u=0;u<o.length;u++)i(o[u]);return i}({1:[function(n,e,t){(function(n){(function(){function t(n){var e=this;return t.is(e)?t.is(n)?e:e.opt(n):new t(n)}!function(n){!function(n){n.fns={is:function(n){return n instanceof Function}},n.bi={is:function(n){return n instanceof Boolean||"boolean"==typeof n}},n.num={is:function(e){return!n.list.is(e)&&(1/0===e||e-parseFloat(e)+1>=0)}},n.text={is:function(n){return"string"==typeof n}},n.text.ify=function(e){return n.text.is(e)?e:"undefined"!=typeof JSON?JSON.stringify(e):e&&e.toString?e.toString():e},n.text.random=function(n,e){var t="";for(n=n||24,e=e||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";n>0;)t+=e.charAt(Math.floor(Math.random()*e.length)),n--;return t},n.text.match=function(e,o){function i(n,e){for(var t,o=-1,i=0;t=e[i++];)if(!~(o=n.indexOf(t,o+1)))return!1;return!0}var r=!1;if(e=e||"",o=t.text.is(o)?{"=":o}:o||{},n.obj.has(o,"~")&&(e=e.toLowerCase()),n.obj.has(o,"="))return e===o["="];if(n.obj.has(o,"*")){if(e.slice(0,o["*"].length)!==o["*"])return!1;r=!0,e=e.slice(o["*"].length)}if(n.obj.has(o,"!")){if(e.slice(-o["!"].length)!==o["!"])return!1;r=!0}if(n.obj.has(o,"+")&&n.list.map(n.list.is(o["+"])?o["+"]:[o["+"]],function(n){return!(e.indexOf(n)>=0)||void(r=!0)}))return!1;if(n.obj.has(o,"-")&&n.list.map(n.list.is(o["-"])?o["-"]:[o["-"]],function(n){return!(e.indexOf(n)<0)||void(r=!0)}))return!1;if(n.obj.has(o,">")){if(!(e>o[">"]))return!1;r=!0}if(n.obj.has(o,"<")){if(!(e<o["<"]))return!1;r=!0}if(n.obj.has(o,"?")){if(!i(e,o["?"]))return!1;r=!0}return r},n.list={is:function(n){return n instanceof Array}},n.list.slit=Array.prototype.slice,n.list.sort=function(n){return function(e,t){return e&&t?(e=e[n],t=t[n],e<t?-1:e>t?1:0):0}},n.list.map=function(e,t,o){return n.obj.map(e,t,o)},n.list.index=1,n.obj={is:function(n){return!(!n||!n.constructor)&&(n.constructor===Object||!(!n.constructor.call||n.constructor.toString().match(/\[native\ code\]/)))}},n.obj.put=function(n,e,t){return(n||{})[e]=t,n},n.obj.del=function(n,e){if(n)return n[e]=null,delete n[e],!0},n.obj.ify=function(e){if(n.obj.is(e))return e;try{e=JSON.parse(e)}catch(n){e={}}return e},n.obj.copy=function(n){return n?JSON.parse(JSON.stringify(n)):n},n.obj.as=function(n,e,t){return n[e]=n[e]||(arguments.length>=3?t:{})},n.obj.has=function(n,e){return n&&Object.prototype.hasOwnProperty.call(n,e)},n.obj.empty=function(e,t){return!e||!n.obj.map(e,function(e,o){if(!t||!(o===t||n.obj.is(t)&&n.obj.has(t,o)))return!!o||void 0})},n.obj.map=function(e,t,o){var i,r,u,a,s,l,c=0,f=0,d=n.fns.is(t),h=function(n,e){return 2===arguments.length?(a=a||{},void(a[n]=e)):(a=a||[],void a.push(n))};if(Object.keys&&n.obj.is(e)&&(s=Object.keys(e),l=!0),n.list.is(e)||s){for(r=(s||e).length;c<r;c++)if(f=c+n.list.index,d){if(u=l?t.call(o||this,e[s[c]],s[c],h):t.call(o||this,e[c],f,h),u!==i)return u}else if(t===e[l?s[c]:c])return s?s[c]:f}else for(c in e)if(d){if(n.obj.has(e,c)&&(u=o?t.call(o,e[c],c,h):t(e[c],c,h),u!==i))return u}else if(t===e[c])return c;return d?a:n.list.index?0:-1},n.time={},n.time.is=function(n){return n?n instanceof Date:+(new Date).getTime()},n.time.now=function(){var e=n.time.is,t=-(1/0),o=0,i=1e3;return function(){var n=e();return t<n?(o=0,t=n):t=n+(o+=1)/i}}()}(n),function(n){function e(){}e.create=function(){var e=function(n){return e.event.e=n,e.event.s[n]=e.event.s[n]||[],e};return e.emit=function(t){var o=e.event.e,i=e.event.s[o],r=arguments,u=r.length;n.list.map(i,function(n,e){return n.fn?1===u?void n.fn(t):void n.fn.apply(n,r):void i.splice(e-1,0)}),i.length||delete e.event.s[o]},e.event=function(n,o){var i=e.event.s[e.event.e];if(i){var r={fn:n,i:o||0,off:function(){return!(r.fn=!1)}};return i.push(r),o?i.sort(t):o,r}},e.event.s={},e};var t=n.list.sort("i");n.on=e.create(),n.on.create=e.create}(n),function(n){var e=function(n,t){e.waiting.push({when:n,event:t||function(){}}),e.soonest<n||e.set(n)};e.waiting=[],e.soonest=1/0,e.sort=n.list.sort("when"),e.set=function(t){if(!(1/0<=(e.soonest=t))){var o=n.time.now();t=t<=o?0:t-o,clearTimeout(e.id),e.id=setTimeout(e.check,t)}},e.check=function(){var t=n.time.now(),o=1/0;e.waiting.sort(e.sort),e.waiting=n.list.map(e.waiting,function(e,i,r){e&&(e.when<=t?n.fns.is(e.event)&&setTimeout(function(){e.event()},0):(o=o<e.when?o:e.when,r(e)))})||[],e.set(o)},n.schedule=e}(n)}(t),function(n){n.version=.3,n._={meta:"_",soul:"#",field:".",state:">","#":"soul",".":"field","=":"value",">":"state"},n.is=function(e){return e instanceof n},n.is.val=function(e){return null===e||e!==1/0&&(!!(n.bi.is(e)||n.num.is(e)||n.text.is(e))||(n.is.rel(e)||!1))},n.is.rel=function(e){if(n.obj.is(e)){var t;if(n.obj.map(e,function(e,o){return t?t=!1:o==n._.soul&&n.text.is(e)?void(t=e):t=!1}),t)return t}return!1},n.is.rel.ify=function(e){var t={};return n.obj.put(t,n._.soul,e),t},n.is.lex=function(e){var t=!0;return!!n.obj.is(e)&&(n.obj.map(e,function(e,o){if(!n.obj.has(n._,o)||!n.text.is(e)&&!n.obj.is(e))return t=!1}),t)},n.is.node=function(e,t,o){var i;return!!n.obj.is(e)&&(!!(i=n.is.node.soul(e))&&!n.obj.map(e,function(i,r){if(r!=n._.meta)return!n.is.val(i)||void(t&&t.call(o,i,r,e))}))},n.is.node.ify=function(e,t,o){return o=n.bi.is(o)?{force:o}:o||{},e=n.is.node.soul.ify(e,t,o.force),n.obj.map(e,function(t,i){n._.meta!==i&&n.is.node.state.ify([e],i,t,o.state=o.state||n.time.now())}),e},n.is.node.soul=function(e,t){return e&&e._&&e._[t||n._.soul]||!1},n.is.node.soul.ify=function(e,t,o){return e=e||{},e._=e._||{},e._[n._.soul]=o?t:e._[n._.soul]||t||n.text.random(),e},n.is.node.state=function(e,t){return!!(t&&e&&e._&&e._[n._.state]&&n.num.is(e._[n._.state][t]))&&e._[n._.state][t]},n.is.node.state.ify=function(e,t,o,i){e=n.list.is(e)?e:[e];var e=e.reverse(),r=e[0];n.list.map(e,function(e,u){e=e||{},n.is.val(o)&&(e[t]=o),e._=e._||{},e=e._[n._.state]=e._[n._.state]||{},(u=r._[n._.state][t])&&(e[t]=u),n.num.is(i)&&(e[t]=i)})},n.is.graph=function(e,t,o,i){var r=!1;return!!n.obj.is(e)&&(!n.obj.map(e,function(e,u){return!e||u!==n.is.node.soul(e)||!n.is.node(e,o)||((t||function(){}).call(i,e,u,function(t){t&&n.is.node(e,t,i)}),void(r=!0))})&&r)},n.is.graph.ify=function(e){var t;if(t=n.is.node.soul(e))return n.obj.put({},t,e)},n.HAM=function(n,e,t,o,i){if(n<e)return{defer:!0};if(e<t)return{historical:!0};if(t<e)return{converge:!0,incoming:!0};if(e===t){if(o===i)return{state:!0};if(String(o)<String(i))return{converge:!0,current:!0};if(String(i)<String(o))return{converge:!0,incoming:!0}}return{err:"you have not properly handled recursion through your data or filtered it as JSON"}},n.union=function(e,t,o,i){function r(t){n.on("operating").emit(e,t)}var i=i||n.obj.is(o)?o:{},u={graph:e.__.graph,count:0};return u.cb=function(){o=n.fns.is(o)?o()&&null:null},u.graph||(u.err={err:n.log("No graph!")}),t||(u.err={err:n.log("No data to merge!")}),(u.soul=n.is.node.soul(t))&&(t=n.is.graph.ify(t)),!n.is.graph(t,null,function(e,t,o){if(!n.num.is(n.is.node.state(o,t)))return u.err={err:n.log("No state on '"+t+"'!")}})||u.err?(u.err=u.err||{err:n.log("Invalid graph!",t)},u):(function(t,o){var o=n.obj.map(o,function(n,e,t){t(n)}).sort(function(e,o){var i=n.is.node.soul(e);return t[i]?1:0});u.count+=1,u.err=n.list.map(o,function(o,a){if(a=n.is.node.soul(o),!a)return{err:n.log("Soul missing or mismatching!")};u.count+=1;var s=t[a];s||(t[a]=s=n.is.node.ify({},a)),n.union.HAM(s,o,function(t,i,r,u){n.on("historical").emit(e,{soul:a,field:i,value:r,state:u,change:o}),e.__.on("historical").emit({soul:a,field:i,change:o})},function(e,t,i,u){if(e){var s=n.is.node.soul.ify({},a);t&&n.is.node.state.ify([e,s,o],t,i),r({soul:a,field:t,value:i,state:u,change:s})}},function(t,i,r,u){n.on("deferred").emit(e,{soul:a,field:i,value:r,state:u,change:o})})(function(){r({soul:a,change:o}),i.soul&&i.soul(a),(u.count-=1)||u.cb()})}),u.count-=1}(u.graph,t),u.count||u.cb(),u)},n.union.ify=function(e,t,o,i){if(e&&(e=e.__&&e.__.graph?e.__.graph:e),n.text.is(t)){if(!e||!e[t])return n.is.node.ify({},t);t=e[t]}var r=n.is.node.soul.ify({},n.is.node.soul(t)),t=n.is.graph.ify(t)||t;if(n.is.graph(t,null,function(o,i){function u(e,t,o){n.is.node.state.ify(e,t,o)}var a;n.is.rel(o)&&(a=e?e[i]||t[i]:t[i]),n.union.HAM(r,a,function(){},function(n,e,t){u([r,a],e,t)},function(){})(function(n){n&&u([r],i,o)})}))return r},n.union.HAM=function(e,t,i,r,u){return u.max=-(1/0),r.end=!0,t=t||{},e=e||{},n.obj.map(t._,function(t,o){n._.state!==o&&n._.soul!==o&&(e._[o]=t)}),n.is.node(t,function a(s,l){r.end=!1;var c,f={incoming:{},current:{}};return f.drift=n.time.now(),f.incoming.value=n.is.rel(s)||s,f.current.value=n.is.rel(e[l])||e[l],f.incoming.state=n.num.is(f.tmp=((t._||{})[n._.state]||{})[l])?f.tmp:-(1/0),f.current.state=n.num.is(f.tmp=((e._||{})[n._.state]||{})[l])?f.tmp:-(1/0),u.max=f.incoming.state>u.max?f.incoming.state:u.max,c=n.HAM(f.drift,f.incoming.state,f.current.state,f.incoming.value,f.current.value),c.err?void o.console.log(".!HYPOTHETICAL AMNESIA MACHINE ERR!.",c.err):c.state||c.historical||c.current?void i.call(c,e,l,s,f.incoming.state):c.incoming?void r.call(c,e,l,s,f.incoming.state):void(c.defer&&(u.wait=!0,u.call(c,e,l,s,f.incoming.state),n.schedule(f.incoming.state,function(){a(s,l),f.incoming.state===u.max&&(u.last||function(){})()})))})?(r.end&&r.call({},e),function(n){u.last=n||function(){},u.wait||u.last()}):function(n){n&&n({err:"Not a node!"})}},n.on.at=function(e){var t=function(n){return t.e=n,t};return t.emit=function(o){return o.soul&&(o.hash=n.on.at.hash(o),n.obj.as(t.mem,t.e)[o.hash]=o),t.all.cb&&t.all.cb(o,t.e),e(t.e).emit(o),{chain:function(n){if(n&&n._&&n._.at)return n._.at(t.e).emit(o)}}},t.only=function(n){if(!t.only.cb)return t.event(t.only.cb=n)},t.all=function(e){t.all.cb=e,n.obj.map(t.mem,function(t,o){n.obj.map(t,function(n,t){e(n,o)})})},t.event=function(o,i){return i=e(t.e).event(o,i),n.obj.map(t.mem[t.e],function(n){i.stat={first:!0},o.call(i,n)}),i.stat={},i},t.map=function(n,e){return t.event(n,e)},t.mem={},t},n.on.at.hash=function(n){return n.at&&n.at.soul?n.at.soul+(n.at.field||""):n.soul+(n.field||"")},n.on.at.copy=function(e){return n.obj.del(e,"hash"),n.obj.map(e,function(n,e,t){t(e,n)})}}(t),function(n){n.chain=n.prototype,n.chain.opt=function(e,t){e=e||{};var o=this,i=o.__&&o.__.gun?o.__.gun:(o._=o.__={gun:o}).gun.chain();return i.__.by=i.__.by||function(n){return o.__.by[n]=o.__.by[n]||{}},i.__.graph=i.__.graph||{},i.__.opt=i.__.opt||{peers:{}},i.__.opt.wire=i.__.opt.wire||{},n.text.is(e)&&(e={peers:e}),n.list.is(e)&&(e={peers:e}),n.text.is(e.peers)&&(e.peers=[e.peers]),n.list.is(e.peers)&&(e.peers=n.obj.map(e.peers,function(n,e,t){t(n,{})})),n.obj.map(e.peers,function(n,e){i.__.opt.peers[e]=n}),n.obj.map(e.wire,function(e,t){n.fns.is(e)&&(i.__.opt.wire[t]=e)}),n.obj.map(["key","on","path","map","not","init"],function(n){e[n]&&(i.__.opt[n]=e[n]||i.__.opt[n])}),t||n.on("opt").emit(i,e),o},n.chain.chain=function(e){var t=this,o=t.back?new this.constructor(t):t;return o._=o._||{},o._.back=o.back||t,o.back=o.back||t,o.__=o.__||t.__,o._.on=o._.on||n.on.create(),o._.at=o._.at||n.on.at(o._.on),o},n.chain.put=function(e,t,o){function i(e){function l(t,o,i){var u;if(t&&(u=t.at)&&t.at.node){if(u.node._||(u.node._={}),u.node._[n._.state]||(u.node._[n._.state]={}),!n.is.node.soul(u.node))if(d.obj===u.obj)n.obj.as(t.graph,u.soul=n.obj.as(u.node._,n._.soul,n.is.node.soul(u.obj)||d.soul),u.node),o(u,u.soul);else{var a=function(e,i){a.opt&&a.opt.on&&a.opt.on.off&&a.opt.on.off(),a.opt.done||(a.opt.done=!0,e&&(t.err=e),u.soul=n.is.node.soul(i)||n.is.node.soul(u.obj)||n.is.node.soul(u.node)||n.text.random(),n.obj.as(t.graph,n.obj.as(u.node._,n._.soul,u.soul),u.node),o(u,u.soul))};a.opt={put:!0},d.not?a():(e.field||e.at?r._.back:r).path(u.path||[],a,a.opt)}u.field&&(u.node._[n._.state][u.field]=s)}}function c(i,a){if(d.ify=a,n.on("put").emit(u,e,d,o,t,f),i||a.err)return t.call(u,i||a.err),u._.at("err").emit(i||a.err);if(i=n.union(u,a.graph,{end:!1,soul:function(e){u.__.by(e).end||n.union(u,n.is.node.soul.ify({},e))}}).err)return t.call(u,i),u._.at("err").emit(i);if(n.fns.is(c.wire=u.__.opt.wire.put)){var s=function(e,o,i){return e?(n.log(e.err||e),t.call(u,e),u._.at("err").emit(e)):t.call(u,e,o)};c.wire(a.graph,s,o)}else n.log.count("no-wire-put")||n.log("Warning! You have no persistence layer to save to!"),t.call(u,null);return d.field?r._.back.path(d.field,null,{chain:o.chain||u}):d.not?r.__.gun.get(d.soul,null,{chain:o.chain||u}):void u.get(d.soul,null,{chain:o.chain||u,at:r._.at})}var f=a.val,d={obj:f};if(d.soul=e.field?e.soul:e.at&&e.at.soul||e.soul,d.field=e.field?e.field:e.at&&e.at.field||e.field,n.is(f))return d.field?f.val(function(o){var r=n.is.node.soul(o);return r?(a.val=n.is.rel.ify(r),void i(e)):(t.call(u,{err:d.err=n.log('Only a node can be linked! Not "'+o+'"!')}),u._.at("err").emit(d.err))}):(t.call(u,{err:d.err=n.log("No field to link node to!")}),u._.at("err").emit(d.err));if(!t.hash[e.hash=e.hash||n.on.at.hash(e)]){if(t.hash[e.hash]=!0,d.by=u.__.by(d.soul),d.not=e.not||e.at&&e.at.not,n.obj.del(e,"not"),n.obj.del(e.at||e,"not"),d.field)n.obj.as(d.obj={},d.field,f);else if(!n.obj.is(f))return t.call(u,d.err={err:n.log("No node exists to put "+typeof f+' "'+f+'" in!')}),u._.at("err").emit(d.err);n.ify(d.obj,l,{pure:!0})(c)}}o=o||{},t=t||function(){},t.hash={};var r=this,u=r.chain(),a={val:e},s=n.time.now();if(r===r.back)i({soul:n.is.node.soul(e)||n.text.random(),not:!0});else{r._.at("soul").map(i);var l=function(t){if(!l.get&&t._.back!==t&&!t._.not)return t._.get&&(l.get=!0),t._.at("null").event(function(i){return this.off(),o.init||t.__.opt.init?n.log("Warning! You have no context to `.put`",e,"!"):void t.init()},-999),l(t._.back)};o.init||r.__.opt.init||l(r)}return u.back=r.back,u},n.chain.get=function(){return n.on("operating").event(function(n,e){n.__.by(e.soul).node||(n.__.by(e.soul).node=n.__.graph[e.soul]),e.field||n.__.on(e.soul).emit(e)}),n.on("get").event(function(e,t,o,i,r){if(!o.halt){if(t.change=t.change||e.__.by(t.soul).node,i.raw)return r.call(i.on,t);o.cb.no||r.call(o.by.chain,null,n.obj.copy(o.node||e.__.by(t.soul).node)),e._.at("soul").emit(t).chain(i.chain)}},0),n.on("get").event(function(n,e,t){if(t.halt)return void(t.halt=!1)},1/0),function(e,t,o){function i(e){var t=e[n._.soul],o=s.__.by(t).node||s.__.graph[t];if(l.force)l.force=!1;else if(o)return!1;return u(e,r,l.opt),!0}function r(e,t,o){return n.on("wire.get").emit(l.by.chain,l,e,t,o),e?(n.log(e.err||e),l.cb.call(l.by.chain,e),l.by.chain._.at("err").emit({soul:l.soul,err:e.err||e}).chain(l.opt.chain)):t?n.obj.empty(t)?void 0:(e=n.union(l.by.chain,t).err)?(l.cb.call(l.by.chain,e),l.by.chain._.at("err").emit({soul:n.is.node.soul(t)||l.soul,err:e.err||e}).chain(l.opt.chain)):void 0:(l.cb.call(l.by.chain,null),l.by.chain._.at("null").emit({soul:l.soul,not:!0}).chain(l.opt.chain))}function u(e,t,o){return n.on("get.wire").emit(l.by.chain,l,e,t,o),n.fns.is(s.__.opt.wire.get)?s.__.opt.wire.get(e,t,o):(n.log.count("no-wire-get")||n.log("Warning! You have no persistence layer to get from!"),void t(null))}function a(e){(a.ran=!0)&&(l.opt.on=this),i(l.lex)||n.on("get").emit(l.by.chain,e,l,l.opt,l.cb,l.lex)}var s=this,l={opt:o||{},cb:t||function(){},lex:n.text.is(e)||n.num.is(e)?n.is.rel.ify(e):e};return l.force=l.opt.force,t!==l.cb&&(l.cb.no=!0),n.obj.is(l.lex)?(l.soul=l.lex[n._.soul])?(l.by=s.__.by(l.soul),l.by.chain=l.by.chain||s.chain(),l.opt.on=(l.opt.at||s.__.at)(l.soul).event(a),l.by.chain._.get=l.lex,l.opt.ran||a.ran||a.call(l.opt.on,{soul:l.soul}),l.by.chain):(l.cb.call(s=this.chain(),{err:n.log("No soul to get!")}),s):(l.cb.call(s=s.chain(),{err:n.log("Invalid get request!",e)}),s)}}(),n.chain.key=function(){return n.on("put").event(function(e,t,o,i,r){i.key||n.is.graph(o.ify.graph,function(t,i){var r={node:e.__.graph[i]};n.is.node.soul(r.node,"key")&&(e.__.by(i).end||(e.__.by(i).end=1),n.is.node(r.node,function r(u,a){var s=e.__.graph[a];return s&&n.is.node.soul(s,"key")?void n.is.node(s,r):(u=o.ify.graph[a]=o.ify.graph[a]||n.is.node.soul.ify({},a),n.is.node(t,function(e,o){n.is.node.state.ify([u,t],o,e)}),void n.obj.del(o.ify.graph,i))}))})}),n.on("get").event(function(e,t,o,i,r){function u(n,t){e.__.gun.get(n,r,{key:o,chain:i.chain||e,force:i.force})}if(!o.halt){if(i.key&&i.key.soul)return t.soul=i.key.soul,e.__.by(i.key.soul).node=n.union.ify(e,i.key.soul),e.__.by(i.key.soul).node._.key="pseudo",void(t.change=n.is.node.soul.ify(n.obj.copy(t.change||e.__.by(t.soul).node),t.soul,!0));if(1===n.is.node.soul(e.__.graph[t.soul],"key")){var a=t.change||e.__.graph[t.soul];o.halt=!0,n.is.node(a,u)}}},-999),function(e,t,o){function i(i){var u={node:r.__.graph[i.soul]};i.soul!==e&&i.key!==e&&(t.hash[i.hash=i.hash||n.on.at.hash(i)]||(t.hash[i.hash]=!0,u.obj=1===n.is.node.soul(u.node,"key")?n.obj.copy(u.node):n.obj.put({},i.soul,n.is.rel.ify(i.soul)),n.obj.as((u.put=n.is.node.ify(u.obj,e,!0))._,"key",1),r.__.gun.put(u.put,function(n,e){t.call(this,n,e)},{chain:o.chain,key:!0,init:!0})))}var r=this;return o=n.text.is(o)?{soul:o}:o||{},t=t||function(){},t.hash={},n.text.is(e)&&e?o.soul?(i({soul:o.soul}),r):(r===r.back?t.call(r,{err:n.log("You have no context to `.key`",e,"!")}):r._.at("soul").map(i),r):(t.call(r,{err:n.log("No key!")}),r)}}(),n.chain.on=function(e,t){function o(o){t.on=t.on||this;var r={by:i.__.by(o.soul)},u=r.by.node;return t.on.stat&&t.on.stat.first&&((o=n.on.at.copy(o)).change=r.by.node),t.raw?e.call(t.on,o):(t.once&&this.off(),t.change&&(u=o.change),void(!t.empty&&n.obj.empty(u,n._.meta)||e.call(r.by.chain||i,n.obj.copy(o.field?u[o.field]:u),o.field||o.at&&o.at.field)))}var i=this;return t=n.obj.is(t)?t:{change:t},e=e||function(){},t.on=i._.at("soul").map(o),i===i.back&&n.log("You have no context to `.on`!"),i},n.chain.path=function(){return n.on("get").event(function(e,t,o,i,r,u){if(!o.halt){i.path&&(t.at=i.path);var a={soul:u[n._.soul],field:u[n._.field]};if(a.change=t.change||e.__.by(t.soul).node,a.field){if(!n.obj.has(a.change,a.field))return;o.node=n.is.node.soul.ify({},t.soul),n.is.node.state.ify([o.node,a.change],a.field,a.change[a.field]),t.change=o.node,t.field=a.field}}},-99),n.on("get").event(function(e,t,o,i,r,u){if(!o.halt){var a={};a.change=t.change||e.__.by(t.soul).node,i.put||n.is.node(a.change,function(o,r){var u=n.on.at.copy(t);u.field=r,u.value=o,n.obj.del(u,"at"),u.change=u.change||a.change,(o=n.is.rel(u.value))&&(u={soul:o,at:u}),e._.at("path:"+r).emit(u).chain(i.chain)}),o.end||(o.end=e._.at("end").emit(t).chain(i.chain))}},99),function(e,t,o){o=o||{},t=t||function(){var n=function(){};return n.no=!0,n}(),t.hash={};var i,r,u=this,a=u.chain();return n.list.is(e)?u===u.back?(t.call(a,o.put?null:{err:n.log("You have no context to `.path`",e,"!")},o.put?u.__.graph[(e||[])[0]]:r),a):(u._.at("path:"+e[0]).event(function(i){if(o.done)return void this.off();var r={soul:i.soul,field:i.field,by:u.__.by(i.soul)},s=e[0],l=n.obj.as(t.hash,i.hash,{off:function(){}});if(i.soul!==l.soul){if(l.off(),r.rel=n.is.rel(i.value)||n.is.rel(i.at&&i.at.value)){if(o.put&&1===e.length)return t.call(r.by.chain||a,null,n.is.node.soul.ify({},r.rel));var c=function(n,o){(n||1===e.length)&&t.call(this,n,o,s)};return r.opt={chain:o.chain||a,put:o.put,path:{soul:i.at&&i.at.soul||i.soul,field:s}},u.__.gun.get(r.rel||i.soul,t.no?null:c,r.opt),void((o.on=t.hash[i.hash]=l=r.opt.on).soul=i.soul)}1===e.length&&t.call(r.by.chain||a,null,i.value,r.field),a._.at("soul").emit(i).chain(o.chain)}}),u._.at("null").only(function(t){t.field&&(t.not&&(u.put({},null,{init:!0}),o.init||u.__.opt.init)||((t=n.on.at.copy(t)).field=e[0],t.not=!0,a._.at("null").emit(t).chain(o.chain)))}),u._.at("end").event(function(i){if(this.off(),!i.at||i.at.field!==e[0]){var r={by:u.__.by(i.soul)};n.obj.has(r.by.node,e[0])||((i=n.on.at.copy(i)).field=e[0],i.not=!0,t.call(r.by.chain||a,null),a._.at("null").emit(i).chain(o.chain))}}),e.length>1&&((i=a.path(e.slice(1),t,o)).back=u),i||a):n.text.is(e)?this.path(e.split("."),t,o):n.num.is(e)?this.path(e+"",t,o):(t.call(a,{err:n.log("Invalid path '"+e+"'!")}),a)}}(),n.chain.map=function(e,t){function o(n,t,o){n||t===u||e.call(this,t,o)}function i(i,r){t.node&&!n.is.rel(i)||(e.hash[this.soul+r]=e.hash[this.soul+r]||this.gun.path(r,o,{chain:s,via:"map"}))}function r(e){var t=a.__.by(e.soul).chain||a;n.is.node(e.change,i,{gun:t,soul:e.soul})}var u,a=this,s=a.chain();return e=e||function(){},e.hash={},t=n.bi.is(t)?{change:t}:t||{},t.change=!n.bi.is(t.change)||t.change,a.on(r,{raw:!0,change:!0}),a===a.back&&n.log("You have no context to `.map`!"),s},n.chain.val=function(){return n.on("get.wire").event(function(n,e){if(e.soul){var t;(t=n.__.by(e.soul)).end=t.end||-1}},-999),n.on("wire.get").event(function(e,t,o,i){if(!o&&t.soul&&(!i||n.obj.empty(i,n._.meta))){var r=e.__.by(t.soul);r.end=!r.end||r.end<0?1:r.end+1}},-999),function(e,t){function i(o){var i={by:r.__.by(o.soul),at:o.at||o},u=i.by.node,a=i.at.field,s=n.on.at.hash({soul:i.at.key||i.at.soul,field:a});if(!e.hash[s]){if(o.field&&n.obj.has(u,o.field))return e.hash[s]=!0,e.call(i.by.chain||r,n.obj.copy(u[o.field]),o.field);if((t.empty||!n.obj.empty(u,n._.meta))&&!(i.by.end<0))return e.hash[s]=!0,e.call(i.by.chain||r,n.obj.copy(u),a)}}var r=this,u=n.list.slit.call(arguments);return e=n.fns.is(e)?e:function(n,e){o.console.log.apply(o.console,u.concat([e&&(e+=":"),n]))},e.hash={},t=t||{},r.on(i,{raw:!0}),r===r.back&&n.log("You have no context to `.val`!"),r}}(),n.chain.not=function(e,t){function o(o,u){if(o.field){if(n.obj.has(i.__.by(o.soul).node,o.field))return n.obj.del(o,"not"),r._.at(u).emit(o)}else if(o.soul&&i.__.by(o.soul).node)return n.obj.del(o,"not"),r._.at(u).emit(o);if(o.not){var a=function(e){return++a.c?n.log("Warning! Multiple `not` resumes!"):void e._.at.all(function(n,e){r._.at(e).emit(n)})};a.c=-1,a.chain=i.chain(),a.next=e.call(a.chain,t.raw?o:o.field||o.soul||o.not,a),a.soul=n.text.random(),n.is(a.next)&&a(a.next),a.chain._.at("soul").emit({soul:a.soul,field:o.field,not:!0,via:"not"})}}var i=this,r=i.chain();return e=e||function(){},t=t||{},i._.at.all(o),i===i.back&&n.log("You have no context to `.not`!"),r._.not=!0,r},n.chain.set=function(e,t,o){var i=this,r={};return t=t||function(){},n.is(e)?((r.chain=e.chain()).back=i,r.chain._=e._,e.val(function(e){if(!r.done){r.done=!0;var u={},a=n.is.node.soul(e);return a?void i.put(n.obj.put(u,a,n.is.rel.ify(a)),t,o):t.call(i,{err:n.log('Only a node can be linked! Not "'+e+'"!')})}}),r.chain):(t.call(i,{err:n.log("Set only supports node references currently!")}),i)},n.chain.init=function(e,t){var o=this;return o._.at("null").event(function(e){if(e.not){var t={by:o.__.by(e.soul)};if(this.off(),e.field){if(n.obj.has(t.by.node,e.field))return;return void o._.at("soul").emit({soul:e.soul,field:e.field,not:!0})}if(e.soul){if(t.by.node)return;var i=n.text.random();o.__.gun.put(n.is.node.soul.ify({},i),null,{init:!0}),o.__.gun.key(e.soul,null,i)}}},{raw:!0}),o}}(t),function(n){function e(e,r,u){u=u||{},r=r||function(e,t){t(e.at,n.is.node.soul(e.at.obj)||n.is.node.soul(e.at.node)||n.text.random())};var a=function(n){s.end=n||function(){},o(s)},s={at:{path:[],obj:e},root:{},graph:{},queue:[],seen:[],opt:u,loop:!0};if(!e)return s.err={err:n.log("Serializer does not have correct parameters.")},a;for(s.opt.start&&n.is.node.soul.ify(s.root,s.opt.start),s.at.node=s.root;s.loop&&!s.err;)i(s,s.at),t(s,r),s.queue.length?s.at=s.queue.shift():s.loop=!1;return a}function t(e,r){var u,a,s=function(t,i){t.soul=t.soul||i||n.is.node.soul(t.obj)||n.is.node.soul(t.node),e.opt.pure||(e.graph[t.soul]=n.is.node.soul.ify(t.node,t.soul),e.at.field&&n.is.node.state.ify([t.node],t.field,u,e.opt.state)),n.list.map(t.back,function(e){e[n._.soul]=t.soul}),o(e)};n.obj.map(e.at.obj,function(o,u){if(e.at.val=o,e.at.field=u,a=r(e,s,t)||!0,u===n._.meta)return void(e.at.node[u]=n.obj.copy(o));if(String(u).indexOf(".")!=-1)return e.err={err:n.log("Invalid field name on '"+e.at.path.join(".")+"'!")};if(n.is.val(o))e.at.node[u]=n.obj.copy(o);else{var l,c={obj:o,node:{},back:[],path:[u]},f={};if(c.path=(e.at.path||[]).concat(c.path||[]),!n.obj.is(o))return e.err={err:n.log("Invalid value at '"+c.path.join(".")+"'!")};(l=i(e,c))?(f[n._.soul]=n.is.node.soul(l.node)||null,(l.back=l.back||[]).push(e.at.node[u]=f)):(e.queue.push(c),f[n._.soul]=null,c.back.push(e.at.node[u]=f))}}),a||r(e,s)}function o(e){if(e.err||!n.list.map(e.seen,function(n){if(!n.soul)return!0})&&!e.loop)return e.end(e.err,e),e.end=function(){}}function i(e,t){return n.list.map(e.seen,function(n){if(t.obj===n.obj)return n})||e.seen.push(t)&&!1}e.wire=function(t,o,i){return n.text.is(t)?e.wire.from(t,o,i):e.wire.to(t,o,i)},e.wire.to=function(e,t,o){var i,r;return e&&(i=n.is.node.soul(e))?(t=t||function(){},i=r="#'"+JSON.stringify(i)+"'",n.obj.map(e,function(o,u){if(n._.meta!==u){var a="",s=n.is.node.state(e,u);s&&(a+=".'"+JSON.stringify(u)+"'",a+="='"+JSON.stringify(o)+"'",a+=">'"+JSON.stringify(s)+"'",i+=a,a=r+a,t(null,a))}}),i):null},e.wire.from=function(n,e,t){if(!n)return null;for(var o=[],i=-1,r=0;(r=n.indexOf("'",i+1))>=0;)i===r||"\\"===n.charAt(r-1)||(o.push(n.slice(i+1,r)),i=r);return o},n.ify=e}(t);var o=this||{};"undefined"!=typeof window&&((o=window).Gun=t),"undefined"!=typeof e&&e.exports&&(e.exports=t),"undefined"!=typeof n&&(o=n),o.console=o.console||{log:function(n){return n}};var i={log:function(n){return o.console.log.apply(o.console,arguments),n},Log:t.log=function(n){return!t.log.squelch&&o.console.log.apply(o.console,arguments),n}};i.debug=function(n,e){return t.log.debug&&n===t.log.debug&&t.log.debug++&&o.console.log.apply(o.console,arguments),e},t.log.count=function(n){return t.log.count[n]=t.log.count[n]||0,t.log.count[n]++}}).bind(this||e)(),function(n){if("undefined"!=typeof window&&window.Gun){if(!window.JSON)throw new Error("Include JSON first: ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js");(function(n){function e(){}e.put=function(n,e,t){try{r.setItem(n,Gun.text.ify(e))}catch(n){t&&t(n)}},e.get=function(n,e){try{e(null,Gun.obj.ify(r.getItem(n)||null))}catch(n){e(n)}},e.del=function(n){return r.removeItem(n)};var t,o,i;try{i=new Date,(t=window.localStorage).setItem(i,i),o=t.getItem(i)!=i,t.removeItem(i),o&&(t=!1)}catch(n){}var r=t&&window.localStorage||{setItem:function(){},removeItem:function(){},getItem:function(){}};n.store=e}).bind(this||e)(n),Gun.on("opt").event(function(e,t){t=t||{};var o=e.tab=e.tab||{};if(o.store=o.store||n.store,o.request=o.request||Gun.request,!o.request)throw new Error("Default GUN driver could not find default network abstraction.");o.request.s=o.request.s||{},o.headers=t.headers||{},o.headers["gun-sid"]=o.headers["gun-sid"]||Gun.text.random(),o.prefix=o.prefix||t.prefix||"gun/",o.get=o.get||function(n,t,i){if(n){var r=n[Gun._.soul];if(r){t=t||function(){};var u={};if((u.headers=Gun.obj.copy(o.headers)).id=o.msg(),function(n,e){o.store.get(o.prefix+n,function(n,t){if(t){if(n)return e(n);e(n,e.node=t),e(n,Gun.is.node.soul.ify({},Gun.is.node.soul(t))),e(n,{})}})}(r,t),!(t.local=i.local)){o.request.s[u.headers.id]=o.error(t,"Error: Get failed!",function(n){setTimeout(function(){o.put(Gun.is.graph.ify(n.body),function(){},{local:!0,peers:{}})},1)}),Gun.obj.map(i.peers||e.__.opt.peers,function(e,i){o.request(i,n,o.request.s[u.headers.id],u),t.peers=!0});var a=e.__.graph[r];a&&o.put(Gun.is.graph.ify(a))}o.peers(t)}}},o.put=o.put||function(n,t,i){t=t||function(){},i=i||{};var r={};(r.headers=Gun.obj.copy(o.headers)).id=o.msg(),Gun.is.graph(n,function(n,i){e.__.graph[i]&&o.store.put(o.prefix+i,e.__.graph[i],function(n){n&&t({err:n})})}),(t.local=i.local)||(o.request.s[r.headers.id]=o.error(t,"Error: Put failed!"),Gun.obj.map(i.peers||e.__.opt.peers,function(e,i){o.request(i,n,o.request.s[r.headers.id],r),t.peers=!0})),o.peers(t)},o.error=function(n,e,t){return function(o,i){return i.body=i.body||i.chunk||i.end||i.write,o||!i||(o=i.body&&i.body.err)?n({err:Gun.log(o||e)}):(t&&t(i),void n(null,i.body))}},o.peers=function(n,e){return Gun.text.is(n)?((e={})[n]={},e):void(n&&!n.peers&&setTimeout(function(){n.local||Gun.log.count("no-peers")||Gun.log("Warning! You have no peers to connect to!"),n.graph||n.node||n(null)},1))},o.msg=o.msg||function(n){return n?(clearTimeout(o.msg.clear),o.msg.clear=setTimeout(function(){var n=Gun.time.is();Gun.obj.map(o.msg.debounce,function(e,t){n-e<3e5||Gun.obj.del(o.msg.debounce,t)})},500),(n=o.msg.debounce[n])?(o.msg.debounce[n]=Gun.time.is(),n):void 0):(o.msg.debounce[n=Gun.text.random(9)]=Gun.time.is(),n)},o.msg.debounce=o.msg.debounce||{},o.server=o.server||function(n,e){if(n&&e&&n.body&&n.headers&&n.headers.id){if(o.request.s[n.headers.rid])return o.request.s[n.headers.rid](null,n);if(!o.msg(n.headers.id)&&!n.headers.rid)return Gun.is.lex(n.body)?o.server.get(n,e):o.server.put(n,e)}},o.server.json="application/json",o.server.regex=e.__.opt.route=e.__.opt.route||t.route||/^\/gun/i,o.server.get=function(n,t){var i,r=n.body[Gun._.soul];if(i=e.__.graph[r]){var u={headers:{"Content-Type":o.server.json,rid:n.headers.id,id:o.msg()}};t({headers:u.headers,body:i})}},o.server.put=function(n,t){var i={headers:{"Content-Type":o.server.json,rid:n.headers.id,id:o.msg()}};return n.body?void(Gun.obj.is(n.body,function(n,t){if(e.__.graph[t])return!0})&&(n.err=Gun.union(e,n.body,function(o,r){if(o)return t({headers:i.headers,body:{err:o||"Union failed."}});var r=r||{};r.graph={},Gun.is.graph(n.body,function(n,t){r.graph[t]=e.__.graph[t]}),e.__.opt.wire.put(r.graph,function(n,e){return n?t({headers:i.headers,body:{err:n||"Failed."}}):void t({headers:i.headers,body:{ok:e||"Persisted."}})},{local:!0,peers:{}})}).err)&&t({headers:i.headers,body:{err:n.err||"Union failed."}})):t({headers:i.headers,body:{err:"No body"}})},Gun.obj.map(e.__.opt.peers,function(){return o.server.able=o.server.able||o.request.createServer(o.server)||!0}),e.__.opt.wire.get=e.__.opt.wire.get||o.get,e.__.opt.wire.put=e.__.opt.wire.put||o.put,e.__.opt.wire.key=e.__.opt.wire.key||o.key,n.request=o.request,Gun.Tab=n})}}.bind(this||e)({}),function(n){var t=function(){function n(e,t,o,i){i=i||{};var r=e.length?{base:e}:{};r.base=i.base||e,r.body=i.body||t,r.headers=i.headers,r.url=i.url,o=o||function(){},r.base&&n.transport(r,o)}return n.createServer=function(e){n.createServer.s.push(e)},n.createServer.ing=function(e,t){for(var o=n.createServer.s.length;o--;)(n.createServer.s[o]||function(){})(e,t)},n.createServer.s=[],n.back=2,n.backoff=2,n.transport=function(e,t){n.ws(e,t)||n.jsonp(e,t)},n.ws=function(e,t){var o,i=n.WebSocket||window.WebSocket||window.mozWebSocket||window.webkitWebSocket;if(i){if(o=n.ws.peers[e.base]){if(!o.readyState)return setTimeout(function(){n.ws(e,t)},10),!0;var r={};return e.headers&&(r.headers=e.headers),e.body&&(r.body=e.body),e.url&&(r.url=e.url),r.headers=r.headers||{},n.ws.cbs[r.headers["ws-rid"]="WS"+ +new Date+"."+Math.floor(65535*Math.random()+1)]=function(e,o){(o.body||o.end)&&delete n.ws.cbs[r.headers["ws-rid"]],t(e,o)},o.send(JSON.stringify(r),function(n){}),!0}if(o!==!1){try{o=n.ws.peers[e.base]=new i(e.base.replace("http","ws"))}catch(n){}return o.onopen=function(o){n.back=2,n.ws(e,t)},o.onclose=function(t){t&&(o&&o.close instanceof Function&&o.close(),1006===t.code,o=n.ws.peers[e.base]=null,setTimeout(function(){n.ws(e,function(){})},n.back*=n.backoff))},"undefined"!=typeof window&&(window.onbeforeunload=o.onclose),o.onmessage=function(t){if(t&&t.data){var o;try{o=JSON.parse(t.data)}catch(n){return}if(o)return o.headers=o.headers||{},o.headers["ws-rid"]?(n.ws.cbs[o.headers["ws-rid"]]||function(){})(null,o):void(o.body&&n.createServer.ing(o,function(t){n(e.base,null,null,t)}))}},o.onerror=function(n){console.log(n)},!0}}},n.ws.peers={},n.ws.cbs={},n.jsonp=function(e,t){return"undefined"==typeof window?t("JSONP is currently browser only."):void n.jsonp.ify(e,function(o){
o&&n.jsonp.send(o,function(o){t(null,o),n.jsonp.poll(e,o)},e.jsonp)})},n.jsonp.send=function(n,e,t){var o=document.createElement("script");return o.src=n,window[o.id=t]=function(n){e(n),e.id=o.id,o.parentNode.removeChild(o),window[e.id]=null;try{delete window[e.id]}catch(n){}},o.async=!0,document.getElementsByTagName("head")[0].appendChild(o),o},n.jsonp.poll=function(e,t){e&&e.base&&t&&t.headers&&t.headers.poll&&((n.jsonp.poll.s=n.jsonp.poll.s||{})[e.base]=n.jsonp.poll.s[e.base]||setTimeout(function(){var t={base:e.base,headers:{pull:1}};n.each(e.headers,function(n,e){t.headers[e]=n}),n.jsonp(t,function(t,o){for(delete n.jsonp.poll.s[e.base];o.body&&o.body.length&&o.body.shift;){var i=o.body.shift();i&&i.body&&n.createServer.ing(i,function(){n(e.base,null,null,i)})}})},t.headers.poll))},n.jsonp.ify=function(e,t){var o=encodeURIComponent,i="?";if(e.url&&e.url.pathname&&(i=e.url.pathname+i),i=e.base+i,n.each((e.url||{}).query,function(n,e){i+=o(e)+"="+o(n)+"&"}),e.headers&&(i+=o("`")+"="+o(JSON.stringify(e.headers))+"&"),n.jsonp.max<i.length)return t();if(i+=o("jsonp")+"="+o(e.jsonp="P"+Math.floor(65535*Math.random()+1)),e.body){i+="&";var r=e.body,u=function(n,e,t){return o("%")+"="+o(n+"-"+(e||n)+"/"+(t||n))+"&"+o("$")+"="};"string"!=typeof r&&(r=JSON.stringify(r),i+=o("^")+"="+o("json")+"&"),r=o(r);var a=0,s=r.length,l=n.jsonp.max-(i.length+u(s.toString()).length);if(l<0)return t();for(;r;)t(i+u(a,a+=l,s)+r.slice(0,a)),r=r.slice(a)}else t(i)},n.jsonp.max=2e3,n.each=function(n,e){if(n&&e)for(var t in n)n.hasOwnProperty(t)&&e(n[t],t)},n}();"undefined"!=typeof window&&(Gun.request=t),"undefined"!=typeof e&&e.exports&&(e.exports.request=t)}.bind(this||e)({})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(n,e,t){"use strict";function o(n){return n&&n.__esModule?n:{default:n}}var i=n("gun/gun"),r=o(i),u=(0,r.default)(["https://gundb-louis.herokuapp.com/gun"]),a=document.getElementById("myInput"),s=u.get("text").not(function(n){u.put({text:""}).key(n)});s.on(function(n){a.value=n.text,document.body.style.backgroundColor=n.text}),window.updateMyInput=function(){s.path("text").put(a.value)}},{"gun/gun":1}]},{},[2]);
//# sourceMappingURL=bundle.min.js.map
